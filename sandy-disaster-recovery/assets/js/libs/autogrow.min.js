!function(e){e.fn.autogrow=function(i){function t(t){var n,s=e(this),l=s.innerHeight(),o=this.scrollHeight,a=s.data("autogrow-start-height")||0;if(o>l)this.scrollTop=0,i.animate?s.stop().animate({height:o},i.speed):s.innerHeight(o);else if(!t||8==t.which||46==t.which||t.ctrlKey&&88==t.which)if(l>a){n=s.clone().addClass(i.cloneClass).css({position:"absolute",zIndex:-10}).val(s.val()),s.after(n);do o=n[0].scrollHeight-1,n.innerHeight(o);while(o===n[0].scrollHeight);o++,n.remove(),s.focus(),a>o&&(o=a),l>o&&i.animate?s.stop().animate({height:o},i.speed):s.innerHeight(o)}else s.innerHeight(a)}var n=e(this).css({overflow:"hidden",resize:"none"}),s=n.selector,l={context:e(document),animate:!0,speed:200,fixMinHeight:!0,cloneClass:"autogrowclone",onInitialize:!1};i=e.isPlainObject(i)?i:{context:i?i:e(document)},i=e.extend({},l,i),n.each(function(n,s){var l,o;elem=e(s),elem.is(":visible")||parseInt(elem.css("height"),10)>0?l=parseInt(elem.css("height"),10)||elem.innerHeight():(o=elem.clone().addClass(i.cloneClass).val(elem.val()).css({position:"absolute",visibility:"hidden",display:"block"}),e("body").append(o),l=o.innerHeight(),o.remove()),i.fixMinHeight&&elem.data("autogrow-start-height",l),elem.css("height",l),i.onInitialize&&t.call(s)}),i.context.on("keyup paste",s,t)}}(jQuery);
