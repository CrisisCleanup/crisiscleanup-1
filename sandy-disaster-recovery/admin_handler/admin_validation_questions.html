{% extends "base_template.html" %}
{% from "_form_utils.html" import render_bootstrap_field %}

{% block main_title %}
<h2>Validation Questions</h2>
{% endblock %}

{% block main_content %}

{% macro render_question_form(form, action) %}
  <form method="POST">
    <input type="hidden" name="prefix" value="{{ form._prefix }}">
    {{ render_bootstrap_field(form.question) }}
    {{ render_bootstrap_field(form.correct_answer) }}
    {% for wrong_answer_field in form.wrong_answers.entries %}
      {{ render_bootstrap_field(wrong_answer_field) }}
    {% endfor %}
    {{ render_bootstrap_field(form.explanation) }}
    {% if action == 'create' %}
      <button type="submit" name="action" value="create" class="btn btn-primary">
        Add Question
      </button>
    {% elif action == 'edit' %}
      <button type="submit" name="action" value="edit" class="btn btn-primary">
        Save Changes
      </button>
      <button type="submit" name="action" value="delete" class="btn btn-default">
        Delete
      </button>
    {% endif %}
  </form>
{% endmacro %}

{% for form in existing_question_forms %}
  {{ render_question_form(form, 'edit') }}
{% endfor %}

<h3>Add a new question</h3>

{{ render_question_form(new_question_form, 'create') }}

{% endblock %}

{% block scripts %}
<script type="text/javascript">
$(function() {
  // ask for confirmation on delete
  $('button[value=delete]').click(function() {
    return confirm("Are you sure you want to delete this question?");
  });
});
</script>
{% endblock %}
