{% if not readonly %}
{% macro with_errors(field) %}
  {% if field.errors %}
    {% set error_class = ' error_field' %}
  {% else %}
    {% set error_class = '' %}
  {% endif %}

  <div class="form_field{{error_class}}">
    {{ field(class=css_class, **kwargs) }}
  </div>
{% endmacro %}
{% else %}

{% macro with_errors(field) %}
    {{ field }}
{% endmacro %}
{% endif %}
<<<<<<< HEAD
 <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>          
<script type="text/javascript">
// Avoid `console` errors in browsers that lack a console.
(function() {
    var method;
    var noop = function () {};
    var methods = [
        'assert', 'clear', 'count', 'debug', 'dir', 'dirxml', 'error',
        'exception', 'group', 'groupCollapsed', 'groupEnd', 'info', 'log',
        'markTimeline', 'profile', 'profileEnd', 'table', 'time', 'timeEnd',
        'timeStamp', 'trace', 'warn'
    ];
    var length = methods.length;
    var console = (window.console = window.console || {});

    while (length--) {
        method = methods[length];

        // Only stub undefined methods.
        if (!console[method]) {
            console[method] = noop;
        }
    }
}());
</script>
    <script type="text/javascript">

{% if post_json %}
        $(function(){
var post_json = {{post_json}};
var oFormObject = document.forms['form'];

Object.keys(post_json).forEach(function(key) {
    var this_element = document.getElementById(key);
    if (key == "priority") {
      var which_button = null;
      if (post_json[key] == "5") {
	which_button = "0";
      }
      if (post_json[key] == "4") {
	which_button = "1";
      }
      if (post_json[key] == "3") {
	which_button = "2";
      }
      if (post_json[key] == "2") {
	which_button = "3";
      }
      if (post_json[key] == "1") {
	which_button = "4";
      }
      
      var new_key = "priority-" + which_button;
      this_element = document.getElementById(new_key);
    }
    var type = null;
    try
    {
      var type = this_element.type;	
      console.log("TYPE: " + type);
      if (type == "text") {
	this_element.value = post_json[key];
      }
      if (type == "textarea") {
	this_element.value = post_json[key];
      }
      
      if (type.indexOf("select") !== -1) {
	this_element.value = post_json[key];
      }
      if (type == "checkbox") {
        if (post_json[key] == "y") {
	  this_element.checked = true;
	}
      }
      
      if (type == "radio") {
	this_element.checked = true;
      }

    }
  catch(err)
    {
      console.log("ERROR, ELEMENT = " + key + err);
      
    }

    console.log(key, post_json[key]);
//     if (key == "name") {
//        var the_element = document.getElementById(key);
//        the_element.value = post_json[key];
//     }
});
})
{% endif %}

    </script>
    <!-- The contents of myscript.js will be loaded inside the script tag -->


<!-- <table id="form_table">
 <p>{{phases_links}}</p>
 <table>
 {{ incident_form_block }}
</table>

{{submit_button}}-->


{{submit_button}}


{{ standard_site_form }}

